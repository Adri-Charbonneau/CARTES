name: TELECHARGEMENT-BDD
on:
  schedule:
    - cron:  '0 5 * * *'
  workflow_dispatch:

jobs:
  TELECHARGEMENT-BDD:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@main
      
      - name: Vérification des codes espèces
        if: always()
        run:  |
          ./SCRIPTS/CODES.ps1

      - name: Téléchargement des bases de données et construction des kml
        if: always()
        run:  |
          ./SCRIPTS/BDD.ps1
      
      - name: Création des cartes Cigales de France et de l'Europe
        if: always()
        run:  |
          choco install r.project pandoc --no-progress -y
          Rscript ./SCRIPTS/CARTES-CDF.R
          Rscript ./SCRIPTS/CARTES-EUROPE.R
          ./SCRIPTS/GIT.ps1